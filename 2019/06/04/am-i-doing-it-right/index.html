<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Am I doing it right? | Ahmed Waleed</title>
    <meta name="generator" content="VuePress 1.6.0">
    
    <meta name="description" content="Every time I write a single line of code I always ask this question to myself: ‚ÄúAm I doing it right?‚Äù or ‚ÄúIs this the right place to put my code‚Äù. I think only by asking these kinds of questions to my ...">
    <link rel="preload" href="/assets/css/0.styles.f20e20f9.css" as="style"><link rel="preload" href="/assets/js/app.b09fd226.js" as="script"><link rel="preload" href="/assets/js/6.743e9d74.js" as="script"><link rel="preload" href="/assets/js/3.f19416b9.js" as="script"><link rel="preload" href="/assets/js/14.7effb013.js" as="script"><link rel="prefetch" href="/assets/js/10.69f07e0e.js"><link rel="prefetch" href="/assets/js/11.53f87820.js"><link rel="prefetch" href="/assets/js/12.7f4e875a.js"><link rel="prefetch" href="/assets/js/13.07629488.js"><link rel="prefetch" href="/assets/js/15.29477e65.js"><link rel="prefetch" href="/assets/js/16.2f940b97.js"><link rel="prefetch" href="/assets/js/17.b6196094.js"><link rel="prefetch" href="/assets/js/18.f3eef25c.js"><link rel="prefetch" href="/assets/js/19.5ab4a430.js"><link rel="prefetch" href="/assets/js/20.9ba5aa1c.js"><link rel="prefetch" href="/assets/js/4.00b7630e.js"><link rel="prefetch" href="/assets/js/5.631f1efc.js"><link rel="prefetch" href="/assets/js/7.a54a7d27.js"><link rel="prefetch" href="/assets/js/8.bde22fe0.js"><link rel="prefetch" href="/assets/js/9.ce3d6c06.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.c82c253b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f20e20f9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/" class="nav-link home-link">Ahmed Waleed </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/" class="nav-link">Blog</a></li><li class="nav-item"><a href="/tag/" class="nav-link">Tags</a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/" class="nav-link mobile-home-link">Ahmed Waleed </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/" class="nav-link">Blog</a></li><li class="mobile-nav-item"><a href="/tag/" class="nav-link">Tags</a></li> <li class="mobile-nav-item"><!----></li></ul></div></div></div> <div class="content-wrapper"><div id="vuepress-theme-blog__post-layout"><article itemscope="itemscope" itemtype="https://schema.org/BlogPosting" class="vuepress-blog-theme-content"><header><h1 itemprop="name headline" class="post-title">
        Am I doing it right?
      </h1> <div class="post-meta"><div itemprop="publisher author" itemtype="http://schema.org/Person" itemscope="itemscope" class="post-meta-author"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-navigation"><polygon points="3 11 22 2 13 21 11 13 3 11"></polygon></svg> <span itemprop="name">Ahmed Waleed</span> <span itemprop="address"> ¬† in Multan, Pakistan</span></div> <div class="post-meta-date"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> <time pubdate itemprop="datePublished" datetime="2019-6-04">
      Tue Jun 04 2019
    </time></div> <ul itemprop="keywords" class="post-meta-tags"><li class="post-tag" data-v-42ccfcd5><a href="/tag/laravel" data-v-42ccfcd5><span data-v-42ccfcd5>laravel</span></a></li><li class="post-tag" data-v-42ccfcd5><a href="/tag/php" data-v-42ccfcd5><span data-v-42ccfcd5>php</span></a></li><li class="post-tag" data-v-42ccfcd5><a href="/tag/design-pattern" data-v-42ccfcd5><span data-v-42ccfcd5>design-pattern</span></a></li><li class="post-tag" data-v-42ccfcd5><a href="/tag/refactoring" data-v-42ccfcd5><span data-v-42ccfcd5>refactoring</span></a></li></ul></div></header> <div itemprop="articleBody" class="content__default"><p>Every time I write a single line of code I always ask this question to myself: ‚ÄúAm I doing it right?‚Äù or ‚ÄúIs this the right place to put my code‚Äù. I think only by asking these kinds of questions to myself I can add much more quality to my code. Now you might be wondering that how asking a question as simple as this can improve your codebase. Let me answer this by giving you an example.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">// PostsController.php</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">store</span><span class="token punctuation">(</span>Request <span class="token variable">$request</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// validating form request</span>
    <span class="token variable">$rules</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'title'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'required'</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'body'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'required'</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token variable">$validator</span> <span class="token operator">=</span> Validator<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$rules</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$validator</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">fails</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'post/create'</span><span class="token punctuation">)</span>
            <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">withErrors</span><span class="token punctuation">(</span><span class="token variable">$validator</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// transforming form data</span>
    <span class="token variable">$attributes</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'title'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">title</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'body'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">body</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">// creating post</span>
    <span class="token variable">$post</span> <span class="token operator">=</span> Post<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token variable">$attributes</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// publish post</span>
    <span class="token variable">$post</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">published_at</span> <span class="token operator">=</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$post</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/posts'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Consider this Laravel controller store function example. This function is doing a couple of things which you can easily understand by reading the comments present in different parts of the function. Now tell me this: Does this code looks perfect to you? If your answer is ‚ÄúNo way man! You are doing too much in a single function‚Äù or ‚Äúwhere is the ‚ÄòS‚Äô (Single Responsibility Principle) of solid principles‚Äù, then I think you wouldn‚Äôt have much difficulty understanding what I am about to explain next.
But if you don‚Äôt know all that stuff, no need to worry! I will explain it to you like we explain something to a 5-year-old child. So stay focused and keep reading!</p> <p>Let‚Äôs consider this block of code and ask the question ‚ÄúAm I doing it right?‚Äù</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">// validating form request</span>
  <span class="token variable">$rules</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
      <span class="token single-quoted-string string">'title'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'required'</span><span class="token punctuation">,</span>
      <span class="token single-quoted-string string">'body'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'required'</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token variable">$validator</span> <span class="token operator">=</span> Validator<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$rules</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$validator</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">fails</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'post/create'</span><span class="token punctuation">)</span>
          <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">withErrors</span><span class="token punctuation">(</span><span class="token variable">$validator</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre></div><p>Does this code belong here? The answer is No. It is violating the Single Responsibly Principle and it shouldn't be here. Its logic must be separated out in a dedicated class which is only responsible for validating incoming request data. Before refactoring that logic into some other place, just think for a minute about the framework you‚Äôre using. Does that provide any feature for validating request data out of the box? In our case, yes, Laravel does provide Form Requests. So let's refactor it now.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">class</span> <span class="token class-name">PostRequest</span> <span class="token keyword">extends</span> <span class="token class-name">FormRequest</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">authorize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean constant">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">rules</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>
            <span class="token single-quoted-string string">'title'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'required'</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'body'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'required'</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


</code></pre></div><p>Now our validation logic is extracted to a dedicated class. It‚Äôs time to move to the next block of code and ask the same question again: ‚ÄúAm I doing it right‚Äù?</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">// transforming form data</span>
<span class="token variable">$attributes</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token single-quoted-string string">'title'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">title</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'body'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">body</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>You might be thinking that leaving these few lines of code won‚Äôt cause the world to end. You‚Äôre right, it won‚Äôt. But what if your form data has hundreds of properties. Can you imagine how messy this could become? You‚Äôll be having hundreds of lines of code just for transforming request data.
Let‚Äôs now extract it out, but where should I? Instead of making a separate class for transforming data, let‚Äôs just think for a few minutes because I don‚Äôt want to pollute my code by creating classes for every line of code.</p> <blockquote><p>Tip: üí° Always ask yourself this: ‚ÄúCan the framework or existing service which you are using handle this logic?‚Äù If it can, there‚Äôs no need for you to make a new one.</p></blockquote> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">class</span> <span class="token class-name">PostRequest</span> <span class="token keyword">extends</span> <span class="token class-name">FormRequest</span>
<span class="token punctuation">{</span>
    <span class="token comment">//</span>
    
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">prepareForValidation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">title</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">title</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">body</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">body</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">//</span>
<span class="token punctuation">}</span>

</code></pre></div><p>I overrode the parent class method which is like a hook and gets called before you have access to your form data. I think that's the right place to transform your data. Imagine what else you can do with that method. Let‚Äôs parse the next block of code.</p> <p>Again ask the same question. For me to have <code>Post::create()</code> in the controller is totally fine but what about publishing a post?</p> <div class="language-php extra-class"><pre class="language-php"><code>Post <span class="token keyword">extends</span> <span class="token class-name">Model</span>
<span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">publish</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">published_at</span> <span class="token operator">=</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>I extracted the publish post logic inside the model publish method because publishing a post logic can be more complicated than two lines. As a rule of thumb, always remember to keep your controllers thin and models fat.</p> <p>Here is the final store function.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">// PostsController.php</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">store</span><span class="token punctuation">(</span>PostRequest <span class="token variable">$request</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$post</span> <span class="token operator">=</span> Post<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">validated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token variable">$post</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/posts'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>I think it‚Äôs a good refactor and you can now see how we simplified our logic and added quality to our code. If you keep asking this question and think before writing any line of code, you won‚Äôt have to master design principles just for writing simple and quality code which you and others can understand easily.</p> <hr> <p>Thanks for reading, if would like to hear more from me, feel free to reach out to me via email or you can follow me on <a href="https://twitter.com/Ahmedwaleed11" target="_blank" rel="noopener noreferrer">Twitter<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p></div> <footer><!----> <hr> <!----></footer></article> <!----></div></div> <footer class="footer" data-v-3d9deeb8><div class="footer-left-wrap" data-v-3d9deeb8><ul class="contact" data-v-3d9deeb8><li class="contact-item" data-v-3d9deeb8><a href="https://github.com/AhmadWaleed" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-3d9deeb8><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github" data-v-3d9deeb8><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22" data-v-3d9deeb8></path></svg>
          
        </a></li><li class="contact-item" data-v-3d9deeb8><a href="mailto:ahmedwaleed11599@gmail.com" class="nav-link external" data-v-3d9deeb8><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail" data-v-3d9deeb8><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" data-v-3d9deeb8></path><polyline points="22,6 12,13 2,6" data-v-3d9deeb8></polyline></svg>
          
        </a></li></ul></div> <div class="footer-right-wrap" data-v-3d9deeb8><ul class="copyright" data-v-3d9deeb8><li class="copyright-item" data-v-3d9deeb8>Ahmed Waleed ¬© 2022</li></ul></div></footer></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.b09fd226.js" defer></script><script src="/assets/js/6.743e9d74.js" defer></script><script src="/assets/js/3.f19416b9.js" defer></script><script src="/assets/js/14.7effb013.js" defer></script>
  </body>
</html>
